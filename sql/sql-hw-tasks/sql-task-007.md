# B"H


## SQL Task 7

---

### Intro:

Take a look at the following `SQL` query:

```sql
select   distinct field_6  
from     `data-science-course-226116.sql_lessons.stock_exchanges_raw_input` 
order by 1
```

The output is:

|field_6|
|---|
|09:30 - 15:00 HKT |
|10:00 - 16:00 Sydney Time |
|8:00 - 17:00 ET |
|9:30 - 16:00 (ET) |
|9:30 - 16:00 ET |
|9:30 - 17:00 ET |
|9:30-16:00 ET |
|Monday - Friday: 1000-1700 |
|Monday - Friday: 400-2000 |
|Monday - Friday: 800 - 1630 |
|Monday - Friday: 800 - 1700 |
|Monday - Friday: 800-1600 |
|Monday - Friday: 800-1630 |
|Monday - Friday: 800-1640 |
|Monday - Friday: 800-2000 |
|Monday - Friday: 800-2200 |
|Monday - Friday: 820-1600 |
|Monday - Friday: 830-1500 |
|Monday - Friday: 830-1630 |
|Monday - Friday: 900-1620 |
|Monday - Friday: 900-1730 |
|Monday - Friday: 900-1732 |
|Monday - Friday: 900-1735 |
|Monday - Friday: 900-1740 |
|Monday - Friday: 900-1742 |
|Monday - Friday: 900-1745 |
|Monday - Friday: 900-2000 |
|Monday - Friday: 915-1530 |
|Monday - Friday: 930 - 1600 |
|Monday - Friday: 930-1600 |
|STK: 9:00-11:30/12:30-15:00 JST |



---

### Task Details:

**Write a query that will return the following output.**

**Hint; the following `SQL` **"tools"** might help:**
- `with` statement
- `case` statement
- `substr` function
- `lower` function
- `strpos` function
- `safe_cast` function
- `cast` function
- `replace` function
- `trim` function
- `concat` function

**How to approach:**
- Try to do one (and only one) *"step"* column in each `with` statement
- That you can slowly build up the solution
- Each *"step"* column is based on prior  *"step"* column(s)
- If you get blocked and can't solve a certain *"step"* column, take a peek at `sql-task-007.sql` - but don't cheat too much :)
- This is a real business-need `SQL` puzzle, so don't be surprised if it takes you a few days or more
- ENJOY!



|field_6|step_00_mon_fri_flag|step_01_remove_mon_fri|step_02_str_pos_of_colon|step_03_str_up_to_first_colon|step_04_str_up_to_first_colon_as_int64|step_05_times_prefix|step_06_remove_times_prefix|step_07_replace_blank_dash_blank|step_08_str_pos_of_colon_zero_zero_blank|step_09_times_suffix|step_10_remove_times_suffix|step_11_remove_colons|step_12_str_pos_of_slash|step_13_times_part_1|step_14_times_part_2|step_15_times_part_1_open|step_16_times_part_1_close|step_17_times_part_2_open|step_18_times_part_2_close|step_19_times_part_1_open_add_00|step_20_times_part_1_close_add_00|step_21_times_part_2_open_add_00|step_22_times_part_2_close_add_00|step_23_times_part_1_open_str_pos_colon|step_24_times_part_1_close_str_pos_colon|step_25_times_part_2_open_str_pos_colon|step_26_times_part_2_close_str_pos_colon|step_27_times_part_1_open_with_new_colon|step_28_times_part_1_close_with_new_colon||step_29_times_part_2_open_with_new_colon|step_30_times_part_2_close_with_new_colon|step_31_times_part_1_open_cast_as_time|step_32_times_part_1_close_cast_as_time|step_33_times_part_2_open_cast_as_time|step_34_times_part_2_close_cast_as_time|
|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|
|09:30 - 15:00 HKT |N|09:30 - 15:00 HKT |3|09|9||09:30 - 15:00 HKT |09:30-15:00 HKT|9|HKT|09:30-15:00|0930-1500|0|0930-1500||0930|1500|||0930:00|1500:00|||5|5|||09:30:00|15:00:00|||09:30:00|15:00:00|||
|10:00 - 16:00 Sydney Time |N|10:00 - 16:00 Sydney Time |3|10|10||10:00 - 16:00 Sydney Time |10:00-16:00 Sydney Time|9|Sydney Time|10:00-16:00|1000-1600|0|1000-1600||1000|1600|||1000:00|1600:00|||5|5|||10:00:00|16:00:00|||10:00:00|16:00:00|||
|8:00 - 17:00 ET |N|8:00 - 17:00 ET |2|8|8||8:00 - 17:00 ET |8:00-17:00 ET|8|ET|8:00-17:00|800-1700|0|800-1700||800|1700|||800:00|1700:00|||4|5|||8:00:00|17:00:00|||08:00:00|17:00:00|||
|9:30 - 16:00 (ET) |N|9:30 - 16:00 (ET) |2|9|9||9:30 - 16:00 (ET) |9:30-16:00 (ET)|8|(ET)|9:30-16:00|930-1600|0|930-1600||930|1600|||930:00|1600:00|||4|5|||9:30:00|16:00:00|||09:30:00|16:00:00|||
|9:30 - 16:00 ET |N|9:30 - 16:00 ET |2|9|9||9:30 - 16:00 ET |9:30-16:00 ET|8|ET|9:30-16:00|930-1600|0|930-1600||930|1600|||930:00|1600:00|||4|5|||9:30:00|16:00:00|||09:30:00|16:00:00|||
|9:30 - 17:00 ET |N|9:30 - 17:00 ET |2|9|9||9:30 - 17:00 ET |9:30-17:00 ET|8|ET|9:30-17:00|930-1700|0|930-1700||930|1700|||930:00|1700:00|||4|5|||9:30:00|17:00:00|||09:30:00|17:00:00|||
|9:30-16:00 ET |N|9:30-16:00 ET |2|9|9||9:30-16:00 ET |9:30-16:00 ET|8|ET|9:30-16:00|930-1600|0|930-1600||930|1600|||930:00|1600:00|||4|5|||9:30:00|16:00:00|||09:30:00|16:00:00|||
|Monday - Friday: 1000-1700 |Y|1000-1700 |0||||1000-1700 |1000-1700|0||1000-1700|1000-1700|0|1000-1700||1000|1700|||1000:00|1700:00|||5|5|||10:00:00|17:00:00|||10:00:00|17:00:00|||
|Monday - Friday: 400-2000 |Y|400-2000 |0||||400-2000 |400-2000|0||400-2000|400-2000|0|400-2000||400|2000|||400:00|2000:00|||4|5|||4:00:00|20:00:00|||04:00:00|20:00:00|||
|Monday - Friday: 800 - 1630 |Y|800 - 1630 |0||||800 - 1630 |800-1630|0||800-1630|800-1630|0|800-1630||800|1630|||800:00|1630:00|||4|5|||8:00:00|16:30:00|||08:00:00|16:30:00|||
|Monday - Friday: 800 - 1700 |Y|800 - 1700 |0||||800 - 1700 |800-1700|0||800-1700|800-1700|0|800-1700||800|1700|||800:00|1700:00|||4|5|||8:00:00|17:00:00|||08:00:00|17:00:00|||
|Monday - Friday: 800-1600 |Y|800-1600 |0||||800-1600 |800-1600|0||800-1600|800-1600|0|800-1600||800|1600|||800:00|1600:00|||4|5|||8:00:00|16:00:00|||08:00:00|16:00:00|||
|Monday - Friday: 800-1630 |Y|800-1630 |0||||800-1630 |800-1630|0||800-1630|800-1630|0|800-1630||800|1630|||800:00|1630:00|||4|5|||8:00:00|16:30:00|||08:00:00|16:30:00|||
|Monday - Friday: 800-1640 |Y|800-1640 |0||||800-1640 |800-1640|0||800-1640|800-1640|0|800-1640||800|1640|||800:00|1640:00|||4|5|||8:00:00|16:40:00|||08:00:00|16:40:00|||
|Monday - Friday: 800-2000 |Y|800-2000 |0||||800-2000 |800-2000|0||800-2000|800-2000|0|800-2000||800|2000|||800:00|2000:00|||4|5|||8:00:00|20:00:00|||08:00:00|20:00:00|||
|Monday - Friday: 800-2200 |Y|800-2200 |0||||800-2200 |800-2200|0||800-2200|800-2200|0|800-2200||800|2200|||800:00|2200:00|||4|5|||8:00:00|22:00:00|||08:00:00|22:00:00|||
|Monday - Friday: 820-1600 |Y|820-1600 |0||||820-1600 |820-1600|0||820-1600|820-1600|0|820-1600||820|1600|||820:00|1600:00|||4|5|||8:20:00|16:00:00|||08:20:00|16:00:00|||
|Monday - Friday: 830-1500 |Y|830-1500 |0||||830-1500 |830-1500|0||830-1500|830-1500|0|830-1500||830|1500|||830:00|1500:00|||4|5|||8:30:00|15:00:00|||08:30:00|15:00:00|||
|Monday - Friday: 830-1630 |Y|830-1630 |0||||830-1630 |830-1630|0||830-1630|830-1630|0|830-1630||830|1630|||830:00|1630:00|||4|5|||8:30:00|16:30:00|||08:30:00|16:30:00|||
|Monday - Friday: 900-1620 |Y|900-1620 |0||||900-1620 |900-1620|0||900-1620|900-1620|0|900-1620||900|1620|||900:00|1620:00|||4|5|||9:00:00|16:20:00|||09:00:00|16:20:00|||
|Monday - Friday: 900-1730 |Y|900-1730 |0||||900-1730 |900-1730|0||900-1730|900-1730|0|900-1730||900|1730|||900:00|1730:00|||4|5|||9:00:00|17:30:00|||09:00:00|17:30:00|||
|Monday - Friday: 900-1732 |Y|900-1732 |0||||900-1732 |900-1732|0||900-1732|900-1732|0|900-1732||900|1732|||900:00|1732:00|||4|5|||9:00:00|17:32:00|||09:00:00|17:32:00|||
|Monday - Friday: 900-1735 |Y|900-1735 |0||||900-1735 |900-1735|0||900-1735|900-1735|0|900-1735||900|1735|||900:00|1735:00|||4|5|||9:00:00|17:35:00|||09:00:00|17:35:00|||
|Monday - Friday: 900-1740 |Y|900-1740 |0||||900-1740 |900-1740|0||900-1740|900-1740|0|900-1740||900|1740|||900:00|1740:00|||4|5|||9:00:00|17:40:00|||09:00:00|17:40:00|||
|Monday - Friday: 900-1742 |Y|900-1742 |0||||900-1742 |900-1742|0||900-1742|900-1742|0|900-1742||900|1742|||900:00|1742:00|||4|5|||9:00:00|17:42:00|||09:00:00|17:42:00|||
|Monday - Friday: 900-1745 |Y|900-1745 |0||||900-1745 |900-1745|0||900-1745|900-1745|0|900-1745||900|1745|||900:00|1745:00|||4|5|||9:00:00|17:45:00|||09:00:00|17:45:00|||
|Monday - Friday: 900-2000 |Y|900-2000 |0||||900-2000 |900-2000|0||900-2000|900-2000|0|900-2000||900|2000|||900:00|2000:00|||4|5|||9:00:00|20:00:00|||09:00:00|20:00:00|||
|Monday - Friday: 915-1530 |Y|915-1530 |0||||915-1530 |915-1530|0||915-1530|915-1530|0|915-1530||915|1530|||915:00|1530:00|||4|5|||9:15:00|15:30:00|||09:15:00|15:30:00|||
|Monday - Friday: 930 - 1600 |Y|930 - 1600 |0||||930 - 1600 |930-1600|0||930-1600|930-1600|0|930-1600||930|1600|||930:00|1600:00|||4|5|||9:30:00|16:00:00|||09:30:00|16:00:00|||
|Monday - Friday: 930-1600 |Y|930-1600 |0||||930-1600 |930-1600|0||930-1600|930-1600|0|930-1600||930|1600|||930:00|1600:00|||4|5|||9:30:00|16:00:00|||09:30:00|16:00:00|||
STK: 9:00-11:30/12:30-15:00 JST |N|STK: 9:00-11:30/12:30-15:00 JST |4|STK||STK|9:00-11:30/12:30-15:00 JST|9:00-11:30/12:30-15:00 JST|20|JST|9:00-11:30/12:30-15:00|900-1130/1230-1500|9|900-1130|1230-1500|900|1130|1230|1500|900:00|1130:00||1230:00|1500:00|4|5|5|5|9:00:00|11:30:00|12:30:00|15:00:00|09:00:00|11:30:00|12:30:00|15:00:00|




